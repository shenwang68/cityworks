!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("reversible-map"),require("https")):"function"==typeof define&&define.amd?define(["exports","reversible-map","https"],t):t((e||self).cityworks={},e.reversibleMap,e.https$1)}(this,function(e,t,n){function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var r=/*#__PURE__*/i(t),u=/*#__PURE__*/s(n),o=require("lodash"),c=function(e,t,n){var i=this;this.name=void 0,this.code=void 0,this.message=void 0,this.error_messages=void 0,this.info=void 0,this.name="Cityworks Exception",this.code=e,this.message=t,this.error_messages=[],void 0!==n&&(o.has(n,"ErrorMessages")&&o.forEach(n.ErrorMessages,function(e){o.set(e,"Service",e.Service.replace(/([a-z])([A-Z])/g,"$1 $2")),o.set(e,"Name",e.Name.replace(/([a-z])([A-Z])/g,"$1 $2")),i.error_messages.push(e)}),o.has(n,"Message")&&(this.message=o.get(n,"Message")),this.info=JSON.stringify(n))},a=require("lodash"),d=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.notifications=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("General/ActivityNotification/User",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.amIWatching=function(e,t){var n=this;return new Promise(function(i,s){var r={null:0,case:1,task:2};void 0===r[e]?s(new c(1,"Activity type provided does not exist.",{provided:e,potential_activities:r})):n.cw.runRequest("General/ActivityNotification/UserWatching",{ActivityType:r[e],ActivityId:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getActivityMetadataByIds=function(e,t){var n=this;return new Promise(function(i,s){var r=["INSPECTION","REQUEST","WORKORDER"];-1==a.indexOf(r,t)&&s(new c(2,"TableName provided does not exist or is mispelled.",{provided:t,available:r})),n.cw.runRequest("General/CwMetaData/ByTableNameSids",{Ids:e,TableName:t}).then(function(e){console.log(e),i(e.Value)}).catch(function(e){s(e)})})},t.getHistory=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Search/RecentActivity",{}).then(function(e){console.log(e),t(e.Value)}).catch(function(e){n(e)})})},t.getWOEntityCostSummary=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/CostSummary/WorkOrderEntity",{ObjectIds:e}).then(function(e){console.log(e),n(e.Value)}).catch(function(e){i(e)})})},t.searchWOEntityCostSummary=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/CostSummary/WorkOrderEntitySearch",{SearchId:e}).then(function(e){console.log(e),n(e.Value)}).catch(function(e){i(e)})})},t.getHolidays=function(e,t){var n=this;return new Promise(function(i,s){var r={},u="General/Holidays/All";void 0===t?(a.set(r,"Date",e),u="General/Holidays/ByDate"):(a.set(r,"StartDate",e),a.set(r,"EndDate",t)),n.cw.runRequest(u,r).then(function(e){console.log(e),i(e.Value)}).catch(function(e){s(e)})})},t.addHolidays=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("General/Holidays/Add",{Holiday:e,Description:t}).then(function(e){console.log(e),i(e.Value)}).catch(function(e){s(e)})})},t.deleteHolidays=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/Holidays/Delete",{Holidays:e}).then(function(e){console.log(e),n(e.Value)}).catch(function(e){i(e)})})},e}(),f=require("lodash");require("fs");var l=/*#__PURE__*/function(){function e(e,t){this.cw=void 0,this.currentActivityType=void 0,this.cw=e,this.currentActivityType=t}var t=e.prototype;return t.add=function(e,t,n,i,s,r){var u=this;void 0===i&&(i="attachment");var o={attachment:0,signature:1,url:2};return new Promise(function(a,d){var l={};void 0!==n&&f.set(l,"Filename",n),void 0!==r&&f.set(l,"Comments",r);var h="";switch(u.currentActivityType){case"Case":h="Pll/CaseRelDocs/Add",f.set(l,"CaObjectId",e);break;case"Inspection":h="Ams/Attachments/AddInspectionAttachment",f.set(l,"InspectionId",e),void 0!==i&&f.set(l,"AttachmentType",o[i]);break;case"Request":f.set(l,"RequestId",e),h="Ams/Attachments/AddRequestAttachment";break;case"WorkOrder":f.set(l,"string"==typeof e?"WorkOrderId":"WorkOrderSid",e),void 0!==s&&f.set(l,"TaskId",s),void 0!==i&&f.set(l,"AttachmentType",o[i]),h="Ams/Attachments/AddWorkOrderAttachment";break;default:d(new c(132,"Unknown current activity type or activity type not set.",{provided:u.currentActivityType}))}u.cw.runRequest(h,l,t).then(function(e){a(e.Value)}).catch(function(e){d(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){var s={},r="";switch("number"==typeof e&&(e=[e]),t.currentActivityType){case"Case":f.set(s,"CaRelDocId",e[0]),r="Pll/CaseRelDocs/Delete";break;case"Inspection":f.set(s,"AttachmentIds",e),r="Ams/Attachments/DeleteInspectionAttachments";break;case"Request":f.set(s,"AttachmentIds",e),r="Ams/Attachments/DeleteRequestAttachments";break;case"WorkOrder":f.set(s,"AttachmentIds",e),r="Ams/Attachments/DeleteWorkOrderAttachments";break;default:i(new c(132,"Unknown current activity type or activity type not set.",{provided:t.currentActivityType}))}t.cw.runRequest(r,s).then(function(e){n(e)}).catch(function(e){i(e)})})},t.download=function(e){var t=this;return new Promise(function(n,i){var s={},r="";switch(t.currentActivityType){case"Case":break;case"Inspection":f.set(s,"AttachmentId",e),r="Ams/Attachments/DownloadInspectionAttachment";break;case"Request":f.set(s,"AttachmentId",e),r="Ams/Attachments/DownloadRequestAttachment";break;case"WorkOrder":f.set(s,"AttachmentId",e),r="Ams/Attachments/DownloadWorkOrderAttachment";break;default:i(new c(132,"Unknown current activity type or activity type not set.",{provided:t.currentActivityType}))}t.cw.runRequest(r,s).then(function(e){n(e)}).catch(function(e){i(e)})})},t.getById=function(e){var t=this;return new Promise(function(n,i){n(!0);var s={},r="";switch(t.currentActivityType){case"Case":break;case"Inspection":f.set(s,"AttachmentId",e),r="Ams/Attachments/InspectionAttachmentById";break;case"Request":f.set(s,"AttachmentId",e),r="Ams/Attachments/RequestAttachmentById";break;case"WorkOrder":f.set(s,"AttachmentId",e),r="Ams/Attachments/WorkOrderAttachmentById";break;default:i(new c(132,"Unknown current activity type or activity type not set.",{provided:t.currentActivityType}))}t.cw.runRequest(r,s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getByNodesId=function(e){var t=this;return new Promise(function(n,i){var s={},r="";switch("number"==typeof e&&(e=[e]),t.currentActivityType){case"Case":f.set(s,"CaObjectId",e),r="Pll/CaseRelDocs/ByCaObjectId";break;case"Inspection":f.set(s,"InspectionIds",e),r="Ams/Attachments/InspectionAttachments";break;case"Request":f.set(s,"RequestIds",e),r="Ams/Attachments/RequestAttachments";break;case"WorkOrder":f.set(s,"string"==typeof e[0]?"WorkOrderIds":"WorkOrderSids",e),r="Ams/Attachments/WorkOrderAttachments";break;default:i(new c(132,"Unknown current activity type or activity type not set.",{provided:t.currentActivityType}))}t.cw.runRequest(r,s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),h=require("lodash"),m=/*#__PURE__*/function(){function e(e){this.activityTypes=void 0,this.linkTypes=void 0,this.cw=void 0,this.cw=e,this.activityTypes=new r.default,this.activityTypes.set("null",0),this.activityTypes.set("case",1),this.activityTypes.set("inspection",2),this.activityTypes.set("request",3),this.activityTypes.set("workorder",4),this.activityTypes.set("wipcase",5),this.linkTypes=new r.default,this.linkTypes.set("null",0),this.linkTypes.set("parent",1),this.linkTypes.set("related",2)}var t=e.prototype;return t.add=function(e,t,n,i,s){var r=this;return void 0===s&&(s="related"),new Promise(function(u,o){r.activityTypes.has(e)||o(new c(1,"Source type not found.",{provided:e,options:r.activityTypes})),r.activityTypes.has(n)||o(new c(2,"Destination type not found.",{provided:n,options:r.activityTypes})),r.linkTypes.has(s)||o(new c(3,"Link type not found.",{provided:s,options:r.linkTypes}));var a={SourceType:r.activityTypes.get(e),SourceSid:t,DestType:r.activityTypes.get(n),DestSid:i,LinkType:r.linkTypes.get(s)};r.cw.runRequest("General/ActivityLink/Add",a).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.get=function(e,t){var n=this;return new Promise(function(i,s){n.activityTypes.has(e)||s(new c(4,"Activity type not found.",{provided:e,options:n.activityTypes}));var r={ActivityType:n.activityTypes.get(e),ActivitySids:t},u=n;n.cw.runRequest("General/ActivityLink/ByActivitySids",r).then(function(e){var t=new Array;h.forEach(e.Value,function(e,n){e.DestType=u.activityTypes.get(e.DestType),e.SourceType=u.activityTypes.get(e.SourceType),e.LinkType=u.linkTypes.get(e.LinkType),t.push(e)}),i(t)}).catch(function(e){s(e)})})},t.clone=function(e,t,n,i){var s=this;return new Promise(function(r,u){s.activityTypes.has(e)||u(new c(5,"Source type not found.",{provided:e,options:s.activityTypes})),s.activityTypes.has(n)||u(new c(6,"Destination type not found.",{provided:n,options:s.activityTypes}));var o={SourceActivityType:s.activityTypes.get(e),SourceActivitySid:t,DestinationActivityType:s.activityTypes.get(n),DestinationActivitySid:i};s.cw.runRequest("General/ActivityLink/CloneByActivitySid",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/ActivityLink/Delete",{ActivityLinkId:e}).then(function(e){n(e)}).catch(function(e){i(e)})})},t.remove=function(e,t,n,i,s){var r=this;return void 0===s&&(s="related"),new Promise(function(u,o){r.activityTypes.has(e)||o(new c(8,"Source type not found.",{provided:e,options:r.activityTypes})),r.activityTypes.has(n)||o(new c(9,"Destination type not found.",{provided:n,options:r.activityTypes})),r.linkTypes.has(s)||o(new c(10,"Link type not found.",{provided:s,options:r.linkTypes}));var a={SourceType:r.activityTypes.get(e),SourceSid:t,DestType:r.activityTypes.get(n),DestSid:i,LinkType:r.linkTypes.get(s)};r.cw.runRequest("General/ActivityLink/Remove",a).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},e}();require("lodash");var v=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.getConfig=function(e,t,n,i){var s=this;return new Promise(function(t,n){e=e.toLowerCase(),s.cw.runRequest("Gis/MapService/Domain",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.domain=function(e,t){var n=this;return new Promise(function(e,t){n.cw.runRequest("Gis/MapService/Domain",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.downloadMobile=function(e,t){var n=this;return new Promise(function(e,t){n.cw.runRequest("Gis/MapService/DownloadMobileMapCache",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.initialExtent=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Gis/MapService/InitialExtent",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.request=function(e,t){var n=this;return new Promise(function(e,t){n.cw.runRequest("Gis/MapService/ServiceRequestConfiguration",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.inspection=function(e,t){var n=this;return new Promise(function(e,t){n.cw.runRequest("Gis/MapService/InspectionConfiguration",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.workOrder=function(e,t){var n=this;return new Promise(function(e,t){n.cw.runRequest("Gis/MapService/WorkOrderConfiguration",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.user=function(e,t,n,i){var s=this;return new Promise(function(e,t){s.cw.runRequest("Gis/MapService/User",{}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.selectedEntities=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("General/AppData/SelectedEntities",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getEntityAttributes=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("AMS/Entity/Attributes",{EntityType:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),p=require("lodash"),w=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.status={Pending:0,Processing:1,Complete:2,Failed:3},this.hook_types={Unknown:0,ActivityUpdate:1,Email:2,WebHook:3},this.cw=e}var t=e.prototype;return t.processMessages=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("General/WebHookEvent/ProcessMessages",{Ids:e,Delete:t}).then(function(e){}).catch(function(e){s(e)})})},t.get=function(e,t,n){var i=this;return void 0===n&&(n=15),new Promise(function(s,r){void 0===i.status[t]&&r(new c(1,"Status provided does not exist or is mispelled.",{provided:t,available:i.status})),i.cw.runRequest("General/MessageQueue/ByIds",{Ids:e,MaxCount:void 0!==n?n:15,Status:i.status[t]}).then(function(e){}).catch(function(e){r(e)})})},t.delete=function(e,t,n){var i=this;return new Promise(function(s,r){void 0===i.status[t]&&r(new c(2,"Status provided does not exist or is mispelled.",{provided:t,available:i.status})),i.cw.runRequest("General/MessageQueue/Delete",{Ids:e,Status:i.status[t],HoursToKeep:n}).then(function(e){}).catch(function(e){r(e)})})},t.preferences=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("General/MessageQueue/Preferences",{}).then(function(e){}).catch(function(e){n(e)})})},t.search=function(e,t){var n,i=this;return new Promise(function(s,r){void 0!==e.status&&void 0===i.status[e.status]?r(new c(3,"Status provided does not exist or is mispelled.",{provided:e.status,available:i.status})):void 0!==e.status&&void 0!==i.status[e.status]&&(n.Status=i.status[e.status]),void 0!==t&&(n.MaxResults=t);var u=["Id","HookId","HookType","Result","DateCreatedBegin","DateCreatedEnd","DateUpdatedBegin","DateUpdatedEnd"],o=["Status","MaxResults"];p.forEach(e,function(e,t){-1!=p.indexOf(u,t)&&-1==p.indexOf(o,t)?n[t]=e:-1==p.indexOf(o,t)&&r(new c(4,"Provided parameter does not exist or is mispelled.",{provided:t,value:e,available:p.concat(u,o)}))}),i.cw.runRequest("General/MessageQueue/Search",n).then(function(e){void 0===e.Value&&(e.Value=[]),s(e.Value)}).catch(function(e){r(e)})})},t.update=function(e){var t,n=this;return new Promise(function(i,s){void 0!==e.status&&void 0===n.status[e.status]?s(new c(3,"Status provided does not exist or is mispelled.",{provided:e.status,available:n.status})):void 0!==e.status&&void 0!==n.status[e.status]&&(t.Status=n.status[e.status]),void 0!==e.hook_types&&void 0===n.hook_types[e.hook_types]?s(new c(3,"Status provided does not exist or is mispelled.",{provided:e.hook_types,available:n.hook_types})):void 0!==e.hook_types&&void 0!==n.hook_types[e.hook_types]&&(t.HookType=n.hook_types[e.hook_types]);var r=["Id","HookId","Packet","Result"],u=["Status","HookType"];p.forEach(e,function(e,n){-1!=p.indexOf(r,n)&&-1==p.indexOf(u,n)?t[n]=e:-1==p.indexOf(u,n)&&s(new c(5,"Provided parameter does not exist or is mispelled.",{provided:n,value:e,available:p.concat(r,u)}))}),n.cw.runRequest("General/MessageQueue/Update",t).then(function(e){void 0===e.Value&&(e.Value=[]),i(e.Value)})})},t.updateMessageStatus=function(e,t,n){var i=this;return new Promise(function(s,r){void 0===i.status[t]&&r(new c(2,"Status provided does not exist or is mispelled.",{provided:t,available:i.status})),i.cw.runRequest("General/MessageQueue/UpdateMessageStatus",{Ids:e,Status:i.status[t],HoursToKeep:n}).then(function(e){})})},t.getWebooks=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/MessageQueue/WebHooks",{HookIds:e}).then(function(e){})})},e}(),y=require("lodash"),I=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.searchTypes={Null:0,Request:1,WorkOrder:2,Inspection:3,Contract:4,Permit:5,GIS:6,PermitTask:7,PermitAddress:8,InspCommon:9,Case:10,WorkOrderEntity:11,StoreTransaction:12,Requisition:13,Material:14,WorkActivity:15,MaterialLeaf:16,WoTemplate:17,Unknown:18,Employee:19,MessageQueue:20,Analytics:21,TokenState:22,AssetCalculationResult:23,Equipment:24,CustomerAccount:25,InspTemplate:26,ProblemLeaf:27,AssetSplitRecord:28,PavementInsp:29,TvInspection:30,Projects:31},this.cw=e}var t=e.prototype;return t.quick=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("General/QuickSearch/QuickSearch",{QuickSearchText:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.execute=function(e,t){var n=this;return new Promise(function(i,s){var r={SearchId:e};r=y.merge(r,t),n.cw.runRequest("Ams/Search/Execute",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getSaved=function(e,t,n,i){var s=this;return new Promise(function(r,u){y.has(s.searchTypes,e)?void 0!==t&&null!=t&&t.length>0&&(void 0!==n||void 0!==i)&&u(new c(3,"You cannot specify both applyToEntities AND employeeSid/domainId")):u(new c(2,"SearchType provided does not exist or is mispelled.",{provided:e,available:s.searchTypes}));var o={},a="";void 0!==n||void 0!==i?(a="SavedByType",void 0!==n&&null!=n&&y.set(o,"EmployeeSid",n),void 0!==i&&null!=i&&y.set(o,"DomainId",i)):(a="Case"==e?"PllSavedSaved":e+"Saved",void 0!==t&&null!=t&&y.set(o,"ApplyToEntities",t)),s.cw.runRequest("Ams/Search/"+a,o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.displayFields=function(e){var t=this;return new Promise(function(n,i){y.has(t.searchTypes,e)||i(new c(1,"SearchType provided does not exist or is mispelled.",{provided:e,available:t.searchTypes}));var s={searchType:y.get(t.searchTypes,e)};t.cw.runRequest("Ams/Search/DisplayFields",s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.types=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Search/Types",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.enableServices=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Search/UpdateEurl",{Enable:!0,SearchIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.disableServices=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Search/UpdateEurl",{Enable:!1,SearchIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getDefinition=function(e,t){var n=this;return new Promise(function(i,s){var r={SearchId:e};void 0!==t&&y.set(r,"EmployeeSid",t),n.cw.runRequest("Ams/Search/Definition",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getDefinitions=function(e,t){var n=this;return new Promise(function(i,s){var r={SearchIds:e};void 0!==t&&y.set(r,"EmployeeSid",t),n.cw.runRequest("Ams/Search/Definitions",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getDefinitionNames=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Search/DefinitionNames",{SearchIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteDefinitions=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Search/DeleteDefinitions",{SearchIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.saveDefinition=function(e,t,n){var i=this;return void 0===n&&(n=0),new Promise(function(s,r){y.has(i.searchTypes,e)||r(new c(1,"SearchType provided does not exist or is mispelled.",{provided:e,available:i.searchTypes}));var u={SearchFor:y.get(i.searchTypes,e),SearchId:n};u=y.merge(u,t),i.cw.runRequest("Ams/Search/SaveDefinition",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.convertToQuery=function(e,t,n,i,s){var r=this;return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),new Promise(function(u,o){r.cw.runRequest("General/Query/SearchToQuery",{SearchIds:e,SaveQuery:t,AddEurl:n,AllowMultipleBooleanValues:i,AllowEmptyQuery:s}).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},e}(),C=require("lodash"),P=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.build=function(e,t,n){var i=this;return void 0===t&&(t={}),new Promise(function(s,r){var u={};isNaN(+e)?C.set(u,"QueryValue",e):isNaN(+e)||C.set(u,"QueryId",e),u=C.merge(u,t),void 0!==n&&C.set(u,"DomainId",n),i.cw.runRequest("General/Query/Builder",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("General/Query/QueryTypes",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getTypesInfo=function(e,t,n){var i=this;return void 0===e&&(e=!0),void 0===t&&(t=!0),new Promise(function(s,r){var u={IncludeDefaultSchemasInclude:e,IncludeGisSchemas:t};void 0!==n&&C.set(u,"DomainId",n),i.cw.runRequest("General/Query/QueryTypeInformation",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.validateQuery=function(e,t,n){var i=this;return new Promise(function(s,r){var u={Query:e,Variables:t};void 0!==n&&C.set(u,"DomainId",n),i.cw.runRequest("General/Query/ValidateQuery",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.validateResponseDefinition=function(e,t,n){var i=this;return new Promise(function(s,r){var u={QueryType:e,ResponseDefinition:t};void 0!==n&&C.set(u,"DomainId",n),i.cw.runRequest("General/Query/ValidateResponseDefinition",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getSchema=function(e,t){var n=this;return new Promise(function(i,s){var r={QueryType:e};void 0!==t&&C.set(r,"DomainId",t),n.cw.runRequest("General/Query/QuerySchema",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.run=function(e,t){var n=this;return void 0===t&&(t={}),new Promise(function(i,s){var r={},u="General/Query/Query";isNaN(+e)?(C.set(r,"QueryValue",e),void 0!==t.QueryValue&&C.unset(t,"QueryValue")):isNaN(+e)||(C.set(r,"QueryId",e),u="General/Query/RunById"),r=C.merge(r,t),n.cw.runRequest(u,r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getSaved=function(e,t,n,i,s){var r=this;return void 0===e&&(e=[]),void 0===t&&(t=!1),void 0===n&&(n=!0),new Promise(function(i,u){var o={CreatedOnly:t,IncludeQuery:n};1==e.length?C.set(o,"QueryType",e.pop()):e.length>1&&C.set(o,"QueryTypes",e),void 0!==s&&C.set(o,"DomainId",s),r.cw.runRequest("General/Query/SavedQueries",o).then(function(e){i(e.Value)}).catch(function(e){u(e)})})},e}(),R=require("lodash"),T=/*#__PURE__*/function(){function e(e){var t=this;this.cw=void 0,this.admin=void 0,this.costs=void 0,this.comment=void 0,this.attachments=void 0,this.updateMLF=function(e){return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/ServiceRequestInstanceMapLayersByRequestId",{ServiceRequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},this.cw=e}var t=e.prototype;return t.create=function(e){var t=this;return new Promise(function(n,i){R.has(e,"ProblemSid")?t.cw.runRequest("Ams/ServiceRequest/Create",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(2,"ProblemSid must be provided.",{provided:e}))})},t.update=function(e){var t=this;return new Promise(function(n,i){R.has(e,"RequestId")?t.cw.runRequest("Ams/ServiceRequest/Update",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(3,"RequestId must be provided.",{provided:e}))})},t.move=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){R.has(i,"WKID")||R.has(i,"WKT")||o(new c(6,"You must provide either the WKID or WKT for the x/y coordinates.",{projection:i}));var a={RequestId:e,X:t,Y:n};void 0!==s&&R.set(a,"Z",s);var d=R.merge(a,i);r.cw.runRequest("Ams/ServiceRequest/Move",d).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.changeProblem=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Ams/ServiceRequest/ChangeProblem",{RequestId:e,ProblemSid:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getById=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/ById",{RequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getByIds=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/ByIds",{RequestIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getAuditLog=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/AuditLog",{RequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getCustomFields=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/CustomFields",{RequestIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.changeCustomFieldCategory=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Ams/ServiceRequest/ChangeCustomFieldCategory",{RequestIds:e,CategoryId:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.cancel=function(e,t,n){var i=this;return new Promise(function(s,r){var u={RequestIds:e};void 0!==t&&R.set(u,"CancelReason",t),void 0!==n&&R.set(u,"DateCancelled",n),i.cw.runRequest("Ams/ServiceRequest/Cancel",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.uncancel=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/Uncancel",{RequestIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.close=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/Close",{RequestIds:e}).then(function(e){e.Status>0?i(new c(5,e.Message,{response:e})):n(e.Value)}).catch(function(e){i(e)})})},t.reopen=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/ReOpen",{RequestIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/Delete",{RequestIds:e}).then(function(e){e.Status>0?i(new c(4,e.Message,{response:e})):n(e.Value)}).catch(function(e){i(e)})})},t.search=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchObject=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/SearchObject",{RequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.createSearchDefinition=function(e,t,n,i,s){var r=this;return void 0===i&&(i=!0),void 0===s&&(s=!0),new Promise(function(n,u){var o=e;R.isString(t)&&(R.set(o,"SearchName",t),R.set(o,"SaveDefinition",i),R.set(o,"EnableEurl",s)),r.cw.runRequest("Ams/ServiceRequest/CreateSearchDefinition",o).then(function(e){n(e.Value)}).catch(function(e){u(e)})})},t.getProblemNodes=function(e,t,n,i){var s=this;return void 0===t&&(t=!1),void 0===i&&(i=!1),new Promise(function(r,u){var o={DomainId:e,IncludeCancelled:i,ViewOnly:t};null!=n&&R.has(n,"DisplayTextMode")&&(R.set(o,"DisplayTextMode",R.get(n,"DisplayTextMode")),"CD"==R.get(n,"DisplayTextMode")&&R.has(n,"DisplayTextDelimeter")&&R.set(o,"DisplayTextDelimeter",R.get(n,"DisplayTextDelimeter"))),s.cw.runRequest("Ams/ServiceRequest/ProblemNodes",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.getProblems=function(e,t,n){var i=this;return void 0===e&&(e=!1),void 0===t&&(t=!0),new Promise(function(s,r){var u={ForPublicOnly:e,OnlyActiveTemplates:t};void 0!==n&&R.set(u,"DomainIds",n),i.cw.runRequest("Ams/ServiceRequest/Problems",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getProblemsByKeywords=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/ProblemsByKeywords",{Keywords:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getPriorities=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/Priorities",{ProblemSids:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getCustomFieldTemplate=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/TemplateCustomFields",{ProblemSids:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getQASettings=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/QA",{ProblemSids:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getProblemLeaf=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/ProblemLeafBySid",{ProblemSid:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getStatuses=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/DefaultStatus",{DomainIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getEmployeeLists=function(e,t){var n=this;return new Promise(function(i,s){var r={DomainId:t};R.includes(["DispatchTo","SubmitTo"],e)?n.cw.runRequest("Ams/ServiceRequest/"+e,r).then(function(e){i(e.Value)}).catch(function(e){s(e)}):s(new c(2,"listType must be either SubmitTo or DispatchTo.",{provided:e}))})},t.getDispatchTos=function(e){return this.getEmployeeLists("DispatchTo",e)},t.getSubmitTos=function(e){return this.getEmployeeLists("SubmitTo",e)},t.streetCodes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/ServiceRequest/AllStreetCode",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getTemplatesById=function(e,t,n){var i=this;return new Promise(function(e,s){var r={ProblemSids:null};void 0!==t&&R.set(r,"MinimumDateModified",t),void 0!==n&&R.set(r,"MaximumDateModified",n),i.cw.runRequest("Ams/ServiceRequestTemplate/ByIds",r).then(function(t){e(t.Value)}).catch(function(e){s(e)})})},t.createTemplateSearchDefinition=function(e,t,n,i){var s=this;return void 0===i&&(i=!0),new Promise(function(n,r){var u=e;R.isString(t)&&(R.set(u,"SearchName",t),R.set(u,"SaveDefinition",i)),s.cw.runRequest("Ams/ServiceRequestTemplate/CreateSearchDefinition",u).then(function(e){n(e.Value)}).catch(function(e){r(e)})})},t.getTemplateQAs=function(e,t,n){var i=this;return new Promise(function(e,t){i.cw.runRequest("Ams/ServiceRequestTemplate/QA",{ProblemSids:null}).then(function(t){e(t.Value)}).catch(function(e){t(e)})})},t.searchTemplates=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequestTemplate/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplates=function(e,t,n,i,s){var r=this;return void 0===t&&(t=!1),void 0===n&&(n=!1),new Promise(function(u,o){var c={CanCreate:t,IncludeInactiveIf:n};void 0!==e&&R.set(c,"TemplateIds",e),void 0!==i&&R.set(c,"MinimumDateModified",i),void 0!==s&&R.set(c,"MaximumDateModified",s),r.cw.runRequest("Ams/ServiceRequestTemplate/Templates",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.getWOTemplates=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/ServiceRequestTemplate/WorkOrderTemplates",{ProblemSids:e,IncludeInactive:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/ServiceRequestInstanceMapLayersByRequestId",{ServiceRequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateMLFs=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c={};R.set(c,"ServiceRequestId",e),R.isNumber(t)&&R.set(c,"X",t),R.isNumber(n)&&R.set(c,"Y",n),R.isNumber(s)&&R.set(c,"Z",s),R.isNumber(i)&&R.set(c,"DomainId",i),r.cw.runRequest("Ams/TemplateMapLayer/UpdateServiceRequestInstanceMapLayers",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.deleteMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/DeleteServiceRequestInstancesByRequestId",{ServiceRequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),q=require("lodash"),A=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.admin=void 0,this.attachments=void 0,this.costs=void 0,this.cw=e}var t=e.prototype;return t.create=function(e){var t=this;return new Promise(function(n,i){q.has(e,"EntityType")&&q.has(e,"InspTemplateId")?t.cw.runRequest("Ams/Inspection/Create",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"EntityType and InspTemplateId properties must be provided.",{provided:e}))})},t.createFromEntities=function(e){var t=this;return new Promise(function(n,i){q.has(e,"EntityType")&&q.has(e,"InspTemplateId")?t.cw.runRequest("Ams/Inspection/CreateFromEntities",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"EntityType and InspTemplateId properties must be provided.",{provided:e}))})},t.createFromParent=function(e){var t=this;return new Promise(function(n,i){q.has(e,"EntityType")&&q.has(e,"InspTemplateId")&&q.has(e,"InspectionId")?t.cw.runRequest("Ams/Inspection/CreateFromParent",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"EntityType and InspTemplateId properties must be provided.",{provided:e}))})},t.createFromServiceRequest=function(e){var t=this;return new Promise(function(n,i){q.has(e,"EntityType")&&q.has(e,"InspTemplateId")&&q.has(e,"RequestId")?t.cw.runRequest("Ams/Inspection/CreateFromServiceRequest",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"EntityType and InspTemplateId properties must be provided.",{provided:e}))})},t.createFromWorkOrder=function(e){var t=this;return new Promise(function(n,i){q.has(e,"EntityType")&&q.has(e,"InspTemplateId")&&q.has(e,"WorkOrderSid")?t.cw.runRequest("Ams/Inspection/CreateFromWorkOrder",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"EntityType and InspTemplateId properties must be provided.",{provided:e}))})},t.update=function(e){var t=this;return new Promise(function(n,i){return new Promise(function(n,i){q.has(e,"InspectionId")?t.cw.runRequest("Ams/Inspection/Update",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(1,"InspectionId must be provided.",{provided:e}))})})},t.getById=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/ById",{InspectionId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getByIds=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/ByIds",{InspectionIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.cancel=function(e,t,n){var i=this;return new Promise(function(s,r){var u={InspectionIds:e};void 0!==t&&(u.CancelReason=t),void 0!==n&&(u.DateCancelled=n),i.cw.runRequest("Ams/Inspection/Cancel",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.uncancel=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/Uncancel",{InspectionIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.close=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/Close",{InspectionIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.reopen=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/Reopen",{InspectionIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/Delete",{InspectionIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.search=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchObject=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequest/SearchObject",{InspectionId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.statuses=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Inspection/Statuses",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.submitTos=function(e,t){var n=this;return void 0===e&&(e=!1),new Promise(function(i,s){var r={};e&&(r.IncludeInactiveEmployees=!0),void 0!==t&&(r.DomainIds=t),n.cw.runRequest("Ams/Inspection/SubmitTos",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.connectAsset=function(e,t,n,i){var s=this;return void 0===i&&(i={}),new Promise(function(n,r){var u={InspectionId:t};q.has(e,"EntityType")&&q.has(e,"EntityUid")?(u.EntityType=e.EntityType,u.EntityUid=e.EntityUid):q.has(e,"Entity")&&(u.Entity=e.Entity),q.has(i,"Facility_Id")&&(u.Facility_Id=i.Facility_Id),q.has(i,"Level_Id")&&(u.Level_Id=i.Level_Id),s.cw.runRequest("Ams/Inspection/AddEntity",u).then(function(e){n(e.Value)}).catch(function(e){r(e)})})},t.getAnswers=function(e){var t=this;return new Promise(function(n,i){var s={};0==e.length?s.InspectionId=e[0]:s.InspectionIds=e,t.cw.runRequest("Ams/Inspection/Answers",s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getAuditLog=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Inspection/AuditLog",{InspectionId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.createSearchDefinition=function(e,t,n,i,s){var r=this;return void 0===i&&(i=!0),void 0===s&&(s=!0),new Promise(function(n,u){var o=e;q.isString(t)&&(q.set(o,"SearchName",t),q.set(o,"SaveDefinition",i),q.set(o,"EnableEurl",s)),r.cw.runRequest("Ams/Inspection/CreateSearchDefinition",o).then(function(e){n(e.Value)}).catch(function(e){u(e)})})},t.getCycleFrom=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Inspection/CycleFrom",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCycleIntervals=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Inspection/CycleIntervals",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCycleTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Inspection/CycleTypes",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getDistricts=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Inspection/Districts",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getEmployeeLists=function(e,t,n){var i=this;return void 0===t&&(t=!1),new Promise(function(s,r){var u={IncludeInactiveEmployees:t};void 0!==n&&null!=n&&q.set(u,"DomainIds",n),"SubmitTos"!=e?r(new c(2,'listType must be "SubmitTos".',{provided:e})):i.cw.runRequest("Ams/Inspection/"+e,u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getSubmitTos=function(e,t){return void 0===e&&(e=!1),this.getEmployeeLists("SubmitTos",e,t)},t.move=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){q.has(i,"WKID")||q.has(i,"WKT")||o(new c(3,"You must provide either the WKID or WKT for the x/y coordinates.",{projection:i}));var a={InspectionId:e,X:t,Y:n};void 0!==s&&q.set(a,"Z",s);var d=q.merge(a,i);r.cw.runRequest("Ams/Inspection/Move",d).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.getTemplates=function(e,t,n){var i=this;return new Promise(function(s,r){var u={};void 0!==e&&(u.EntityTypes=e),u.CanCreate=void 0===t||t,"object"==typeof n&&q.forIn(n,function(e,t){u[t]=e}),i.cw.runRequest("Ams/InspectionTemplate/Templates",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getTemplatesByIds=function(e,t){var n=this;return new Promise(function(i,s){var r={InspTemplateIds:e};"object"==typeof t&&q.forIn(t,function(e,t){r[t]=e}),n.cw.runRequest("Ams/InspectionTemplate/ByIds",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getTemplateEntityTypes=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/InspectionTemplate/EntityTypes",{InspTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getQA=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/InspectionTemplate/QA",{InspTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getQConditions=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/InspectionTemplate/QuestionConditions",{InspTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/ServiceRequestInstanceMapLayersByRequestId",{ServiceRequestId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateMLFs=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c={};q.set(c,"ServiceRequestId",e),q.isNumber(t)&&q.set(c,"X",t),q.isNumber(n)&&q.set(c,"Y",n),q.isNumber(s)&&q.set(c,"Z",s),q.isNumber(i)&&q.set(c,"DomainId",i),r.cw.runRequest("Ams/TemplateMapLayer/UpdateServiceRequestInstanceMapLayers",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.deleteMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/DeleteInspectionInstancesByInspectionId",{InspectionId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),g=require("lodash"),k=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.admin=void 0,this.costs=void 0,this.comment=void 0,this.attachments=void 0,this.cw=e}var t=e.prototype;return t.create=function(e,t,n){var i=this;return new Promise(function(s,r){if(g.has(e,"WOTemplateId")&&g.has(e,"EntityType")){var u=e;void 0===t||null==t||g.has(u,"InspectionIds")||g.set(u,"InspectionIds",t),void 0===n||null==n||g.has(u,"RequestIds")||g.set(u,"RequestIds",n),i.cw.runRequest("Ams/WorkOrder/Create",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})}else r(new c(2,"WOTemplateId & EntityType must be provided.",{provided:e}))})},t.createFromParent=function(e,t,n){var i=this;return new Promise(function(n,s){if(g.has(e,"WOTemplateId")&&g.has(e,"EntityType")){var r=e;g.isString(t)?g.set(r,"WorkOrderId",t):g.set(r,"WorkOrderSid",t),i.cw.runRequest("Ams/WorkOrder/Create",r).then(function(e){n(e.Value)}).catch(function(e){s(e)})}else s(new c(2,"WOTemplateId & EntityType must be provided.",{provided:e}))})},t.update=function(e){var t=this;return new Promise(function(n,i){g.has(e,"WorkOrderSid")||g.has(e,"WorkOrderId")?t.cw.runRequest("Ams/WorkOrder/Update",e).then(function(e){n(e.Value)}).catch(function(e){i(e)}):i(new c(3,"WorkOrderId or WorkOrderSid must be provided.",{provided:e}))})},t.combine=function(e,t,n){var i=this;return void 0===n&&(n=!0),new Promise(function(s,r){i.cw.runRequest("Ams/WorkOrder/Combine",{CancelCombinedWorkOrders:n,ToWorkOrderId:t,FromWorkOrderIds:e}).then(function(e){e.Status>0?r(new c(4,e.Message,{response:e})):s(e.Value)}).catch(function(e){r(e)})})},t.move=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){g.has(i,"WKID")||g.has(i,"WKT")||o(new c(6,"You must provide either the WKID or WKT for the x/y coordinates.",{projection:i}));var a={WorkOrderId:e,X:t,Y:n};void 0!==s&&g.set(a,"z",s);var d=g.merge(a,i);r.cw.runRequest("Ams/WorkOrder/Move",d).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.getById=function(e,t){var n=this;return new Promise(function(t,i){var s={};if(g.isString(e)){g.set(s,"WorkOrderId",e);var r="Ams/WorkOrder/ById"}else g.set(s,"WorkOrderSid",e),r="Ams/WorkOrder/BySid";n.cw.runRequest(r,s).then(function(e){t(e.Value)}).catch(function(e){i(e)})})},t.getByIds=function(e){var t=this;return new Promise(function(n,i){var s={};if(0==e.length)i(new c(101,"No workorder S/IDs were provided.",{workorderSId:e}));else{var r="Ams/WorkOrder/ByIds";g.isString(e[0])?(g.set(s,"WorkOrderIds",e),r="Ams/WorkOrder/ByIds"):g.isNumber(e[0])?(g.set(s,"WorkOrderSids",e),r="Ams/WorkOrder/BySids"):i(new c(9,"No workorder S/IDs were provided.",{workorderSId:e})),t.cw.runRequest(r,s).then(function(e){n(e.Value)}).catch(function(e){i(e)})}})},t.getInstructions=function(e){var t=this;return new Promise(function(n,i){var s={};if(0==e.length)i(new c(102,"No workorder S/IDs were provided.",{workorderSId:e}));else{var r="Ams/WorkOrder/ByIds";g.isString(e[0])?(g.set(s,"WorkOrderIds",e),r="Ams/WorkOrder/InstructionsByWorkOrderIds"):g.isNumber(e[0])?(g.set(s,"WorkOrderSids",e),r="Ams/WorkOrder/InstructionsByWorkOrderSids"):i(new c(9,"No workorder S/IDs were provided.",{workorderSId:e})),t.cw.runRequest(r,s).then(function(e){n(e.Value)}).catch(function(e){i(e)})}})},t.getAuditLog=function(e){var t=this;return new Promise(function(n,i){var s={};g.isString(e)?g.set(s,"WorkOrderId",e):g.isNumber(e)?g.set(s,"WorkOrderSid",e):i(new c(9,"Workorder S/IDs was not provided.",{workorderSId:e})),t.cw.runRequest("Ams/WorkOrder/AuditLog",s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getCustomFieldValues=function(e){var t=this;return new Promise(function(n,i){var s={},r="Ams/WorkOrder/CustomFields";g.isString(e[0])?(g.set(s,"WorkOrderIds",e),r="Ams/WorkOrder/CustomFields"):g.isNumber(e[0])?(g.set(s,"WorkOrderSids",e),r="Ams/WorkOrder/CustomFieldsByWorkOrderSids"):i(new c(9,"No workorder S/IDs were provided.",{workorderSIds:e})),t.cw.runRequest(r,s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getEntities=function(e,t){var n=this;return void 0===t&&(t=!0),new Promise(function(i,s){var r={GetGisData:t};0==e.length?s(new c(11,"No workorder S/IDs were provided.",{workorderSId:e})):g.isString(e[0])?g.set(r,"WorkOrderIds",e):g.isNumber(e[0])?g.set(r,"WorkOrderSids",e):s(new c(12,"No workorder S/IDs were provided.",{workorderSId:e})),n.cw.runRequest("Ams/WorkOrder/Entities",r).then(function(e){e.Status>0?s(new c(4,e.Message,{response:e})):i(e.Value)}).catch(function(e){s(e)})})},t.addEntities=function(e,t,n){var i=this;return void 0===n&&(n=!0),new Promise(function(s,r){var u={UpdateXY:n};g.isString(e)?g.set(u,"WorkOrderId",e):g.set(u,"WorkOrderSid",e),g.has(t,"Facility_Id")&&g.set(u,"Facility_Id",g.get(t,"Facility_Id")),g.has(t,"Level_Id")&&g.set(u,"Level_Id",g.get(t,"Level_Id")),g.has(t,"EntityUids")&&g.has(t,"EntityType")?(g.set(u,"EntityUids",g.get(t,"EntityUids")),g.set(u,"EntityType",g.get(t,"EntityType"))):r(new c(7,"No entity info was provided.",{workorderSId:e,entityInfo:t})),i.cw.runRequest("Ams/WorkOrder/AddEntities",u).then(function(e){e.Status>0?r(new c(4,e.Message,{response:e})):s(e.Value)}).catch(function(e){r(e)})})},t.updateEntity=function(e,t,n){var i=this;return void 0===n&&(n=!1),new Promise(function(s,r){var u={WorkComplete:n};g.isString(e)?g.set(u,"WorkOrderId",e):g.set(u,"WorkOrderSid",e),g.has(t,"Facility_Id")&&g.set(u,"Facility_Id",g.get(t,"Facility_Id")),g.has(t,"Level_Id")&&g.set(u,"Level_Id",g.get(t,"Level_Id")),g.has(t,"EntityUids")&&g.has(t,"EntityType")?(g.set(u,"EntityUid",g.get(t,"EntityUid")),g.set(u,"EntityType",g.get(t,"EntityType"))):r(new c(7,"No entity info was provided.",{workorderSId:e,entityInfo:t})),i.cw.runRequest("Ams/WorkOrder/UpdateEntity",u).then(function(e){e.Status>0?r(new c(4,e.Message,{response:e})):s(e.Value)}).catch(function(e){r(e)})})},t.removeEntities=function(e,t,n){var i=this;return void 0===n&&(n=!0),new Promise(function(s,r){var u={UpdateXY:n};g.isString(e)?g.set(u,"WorkOrderId",e):g.set(u,"WorkOrderSid",e),g.has(t,"ObjectIds")?g.set(u,"ObjectIds",g.get(t,"ObjectIds")):g.has(t,"EntityUids")&&g.has(t,"EntityType")?(g.set(u,"EntityUids",g.get(t,"EntityUids")),g.set(u,"EntityType",g.get(t,"EntityType"))):r(new c(8,"No entity info was provided.",{workorderSId:e,entityInfo:t})),i.cw.runRequest("Ams/WorkOrder/RemoveEntities",u).then(function(e){e.Status>0?r(new c(4,e.Message,{response:e})):s(e.Value)}).catch(function(e){r(e)})})},t.cancel=function(e,t,n){var i=this;return new Promise(function(s,r){var u={WorkOrderIds:e};void 0!==t&&g.set(u,"CancelReason",t),void 0!==n&&g.set(u,"DateCancelled",n),i.cw.runRequest("Ams/WorkOrder/Cancel",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.uncancel=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/WorkOrder/Uncancel",{WorkOrderIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.close=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/WorkOrder/Close",{WorkOrderIds:e}).then(function(e){e.Status>0?i(new c(5,e.Message,{response:e})):n(e.Value)}).catch(function(e){i(e)})})},t.reopen=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/WorkOrder/ReOpen",{WorkOrderIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/WorkOrder/Delete",{WorkOrderIds:e}).then(function(e){e.Status>0?i(new c(4,e.Message,{response:e})):n(e.Value)}).catch(function(e){i(e)})})},t.getWOsByEntities=function(e,t,n,i){var s=this;return void 0===i&&(i=!0),new Promise(function(r,u){var o={};void 0!==n&&g.merge(o,n),g.has(o,"EntityType")||g.set(o,"EntityType",e),g.has(o,"EntityUids")||g.set(o,"EntityUids",t);var a="Ams/WorkOrder/SearchForSids";i||(a="Ams/WorkOrder/Search"),s.cw.runRequest(a,o).then(function(e){e.Status>0?u(new c(4,e.Message,{response:e})):r(e.Value)}).catch(function(e){u(e)})})},t.getSearchList=function(e){var t=this;return new Promise(function(n,i){var s={};g.set(s,"WorkOrderId",e),t.cw.runRequest("Ams/WorkOrder/SearchObject",s).then(function(e){e.Status>0?i(new c(4,e.Message,{response:e})):n(e.Value)}).catch(function(e){i(e)})})},t.getEmployeeLists=function(e,t,n){var i=this;return void 0===t&&(t=!1),new Promise(function(s,r){var u={IncludeInactiveEmployees:t};void 0!==n&&null!=n&&g.set(u,"DomainIds",n),g.includes(["Supervisors","SubmitTos"],e)?i.cw.runRequest("Ams/WorkOrder/"+e,u).then(function(e){s(e.Value)}).catch(function(e){r(e)}):r(new c(2,"listType must be either SubmitTos or Supervisors.",{provided:e}))})},t.getSubmitTos=function(e,t){return void 0===e&&(e=!1),this.getEmployeeLists("SubmitTos",e,t)},t.getSupervisors=function(e,t){return void 0===e&&(e=!1),this.getEmployeeLists("Supervisors",e,t)},t.getStatuses=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/Statuses",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCategories=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/Categories",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getPriorities=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/Priorities",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCycleFrom=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/CycleFrom",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCycleIntervals=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/CycleIntervals",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getCycleTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/CycleTypes",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getStages=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/Stages",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getExpenseTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/WorkOrder/ExpenseTypes",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/WorkOrderInstanceMapLayersByWorkOrderId",{WorkOrderId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateMLFs=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var a={};g.isString(e)?g.set(a,"WorkOrderId",e):g.isNumber(e)?g.set(a,"WorkOrderSid",e):o(new c(9,"No workorder S/ID was provided.",{workorderSId:e})),g.isNumber(t)&&g.set(a,"X",t),g.isNumber(n)&&g.set(a,"Y",n),g.isNumber(s)&&g.set(a,"Z",s),g.isNumber(i)&&g.set(a,"DomainId",i),r.cw.runRequest("Ams/TemplateMapLayer/UpdateWorkOrderInstanceMapLayers",a).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.deleteMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/DeleteWorkOrderInstancesByWorkOrderId",{WorkOrderId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),S=require("lodash");require("querystring");var V=require("fs"),D=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.current_case=0,this.data=void 0,this.asset=void 0,this.attachments=void 0,this.workflow=void 0,this.financial=void 0,this.comment=void 0,this.admin=void 0,this.cw=e}var t=e.prototype;return t.create=function(e,t,n){var i=this;return new Promise(function(s,r){var u=S.merge({CaseTypeId:e,SubTypeId:t},n);i.cw.runRequest("Pll/Case/Create",u).then(function(e){i.current_case=e.Value.CaObjectId,s(e.Value)}).catch(function(e){r(e)})})},t.createChild=function(e,t,n){var i=this;return new Promise(function(s,r){var u=S.merge({BusCaseId:e,ParentCaObjectId:t},n);i.cw.runRequest("Pll/Case/CreateChild",u).then(function(e){i.current_case=e.Value.CaObjectId,s(e.Value)}).catch(function(e){r(e)})})},t.createFromRequest=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o=S.merge({CaseTypeId:e,SubTypeId:t,ServiceRequestId:n},i);s.cw.runRequest("Pll/CaseObject/CreateCaseFromServiceRequest",o).then(function(e){s.current_case=e.Value.CaObjectId,r(e.Value)}).catch(function(e){u(e)})})},t.update=function(e,t){var n=this;return new Promise(function(i,s){var r=S.merge({CaObjectId:e},t);n.cw.runRequest("Pll/CaseObject/Update",r).then(function(e){n.current_case=e.Value.CaObjectId,i(e.Value)}).catch(function(e){s(e)})})},t.getByIds=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseObject/ByIds",{CaObjectIds:e}).then(function(e){1==e.Value.length&&(t.current_case=e.Value[0]),n(e.Value)}).catch(function(e){i(e)})})},t.search=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseObject/Search",e).then(function(e){1==e.Value.length&&(t.current_case=e.Value[0].CaObjectId),n(e.Value)}).catch(function(e){i(e)})})},t.move=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){S.has(i,"WKID")||S.has(i,"WKT")||o(new c(1,"You must provide either the WKID or WKT for the x/y coordinates.",{projection:i}));var a={CaObjectId:e,X:t,Y:n};void 0!==s&&S.set(a,"Z",s);var d=S.merge(a,i);r.cw.runRequest("Pll/CaseObject/Move",d).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.delete=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseObject/DeleteCase",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/CaseInstanceMapLayersByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateMLFs=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c={CaObjectId:e};S.isNumber(t)&&S.set(c,"X",t),S.isNumber(n)&&S.set(c,"Y",n),S.isNumber(s)&&S.set(c,"Z",s),S.isNumber(i)&&S.set(c,"DomainId",i),r.cw.runRequest("Ams/TemplateMapLayer/UpdateCaseInstanceMapLayers",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.deleteMLFs=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/TemplateMapLayer/DeleteCaseInstanceMapLayersByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getPrintTemplates=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/BusinessCaseReports/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.print=function(e,t,n){var i=this;return new Promise(function(s,r){var o={CaObjectId:e,FileName:t},c=i.cw.getRequestOptions("Pll/BusinessCaseReports/Download","GET");console.log(c),console.log(__dirname+t+".pdf");var a=V.createWriteStream(__dirname.replace("/dist","/downloads")+"/"+t+".pdf"),d="https://"+c.hostname+c.path+"?data="+JSON.stringify(o)+"&Token="+i.cw.getToken();u.get(d,{timeout:1e7},function(e){e.on("data",function(e){a.write(e)}),e.on("end",function(){a.close(n("Success"))})}).on("error",function(e){a.close(n("Failure")),console.error(e)})})},e}(),b=require("lodash"),O=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.addGroup=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o={CaObjectId:e,CaseDataGroupId:t,GroupCode:n};void 0!==i&&(o=b.merge(o,i)),s.cw.runRequest("Pll/CaseDataGroup/Add",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.addDefaultGroups=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CaseDataGroup/AddDefault",{CaObjectId:e,BusCaseId:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.wipAddDetail=function(e,t,n,i,s,r){var u=this;return new Promise(function(o,c){var a=b.merge({CaseDataDetailId:e,CaDataGroupId:t,ColumnSequence:n,DetailCode:i,DetailSequence:s},r);u.cw.runRequest("Pll/CaseDataGroup/Add",a).then(function(e){o(e.Value)}).catch(function(e){c(e)})})},t.getGroupsByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataGroup/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteGroupsByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataGroup/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForGroups=function(e){var t=this;return new Promise(function(n,i){0==b.intersectionBy(b.keysIn(e),["CaDataGroupId","CaseDataGroupId","GroupCode","GroupDesc","GroupSum","SumFlag"]).length&&i(new c(2,"At least one of the attributes (CaDataGroupId, CaseDataGroupId, GroupCode, GroupDesc, GroupSum, SumFlag) must be defined.")),t.cw.runRequest("Pll/CaseDataGroup/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.checkGIS=function(e,t,n){var i=this;return new Promise(function(s,r){var u={EntityType:e,EntityUid:t};b.has(n,"CaObjectId")?b.set(u,"CaObjectId",b.get(n,"CaObjectId")):b.has(n,"CaseDataGroupId")?b.set(u,"CaseDataGroupId",b.get(n,"CaseDataGroupId")):r(new c(1,"Either CaObjectId or CaseDataGroupId is required.",{provided:n})),b.has(n,"CaseDataDetailId")&&b.set(u,"CaseDataDetailId",b.get(n,"CaseDataDetailId")),i.cw.runRequest("Pll/CaseDataGroup/CheckGISChanges",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.updateGroupsFromAsset=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o={CaObjectId:e,EntityType:t,EntityUid:n};void 0!==i&&b.set(o,"CaDataGroupId",i),s.cw.runRequest("Pll/CaseDataGroup/UpdateFromAsset",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.addDetail=function(e,t,n){var i=this;return new Promise(function(s,r){var u={CaDataGroupId:e,CaseDataDetailId:t};void 0!==n&&(u=b.merge(u,n)),i.cw.runRequest("Pll/CaseDataDetail/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.updateDetail=function(e,t){var n=this;return new Promise(function(i,s){var r={CaDataDetailId:e};void 0!==t&&(r=b.merge(r,t)),n.cw.runRequest("Pll/CaseDataDetail/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.lockDetail=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataDetail/UpdateLock",{CaDataDetailId:e,Lock:!0}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.unlockDetail=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataDetail/UpdateLock",{CaDataDetailId:e,Lock:!1}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForDetails=function(e){var t=this;return new Promise(function(n,i){0==b.intersectionBy(b.keysIn(e),["CaDataDetailId","CaDataGroupId","CalcRateFlag","CaseDataDetailId","CommentFlag","DateFlag","DetailCode","DetailDesc","ListValuesFlag","NumberFlag","TextFlag","ValueFlag","YesNoFlag"]).length&&i(new c(2,"At least one of the attributes (CaDataDetailId, CaDataGroupId, CalcRateFlag, CaseDataDetailId, CommentFlag, DateFlag, DetailCode, DetailDesc, ListValuesFlag, NumberFlag, TextFlag, ValueFlag, YesNoFlag) must be defined.")),t.cw.runRequest("Pll/CaseDataDetail/SearchObject",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.addListValue=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CaseDataListValues/Add",{CaDataDetailId:e,ListValue:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteListValue=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataListValues/Delete",{CaDataDetailId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForListValueIds=function(e){var t=this;return new Promise(function(n,i){0==b.intersectionBy(b.keysIn(e),["CaDataDetailId","CaDataListId","ListValue"]).length&&i(new c(3,"At least one of the attributes (CaDataDetailId, CaDataListId, ListValue) must be defined.")),t.cw.runRequest("Pll/CaseDataGroup/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForListValueObjects=function(e){var t=this;return new Promise(function(n,i){0==b.intersectionBy(b.keysIn(e),["CaDataDetailId","CaDataListId","ListValue","CaDataGroupId"]).length&&i(new c(4,"At least one of the attributes (CaDataDetailId, CaDataListId, ListValue, CaDataGroupId) must be defined.")),t.cw.runRequest("Pll/CaseDataGroup/SearchObject",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateDetailItemValue=function(e,t){var n=this;return new Promise(function(i,s){n.searchForDetails({CaDataDetailId:e}).then(function(r){0==r.length&&s(new c(1,"No data detail found with CaDataDetailId "+e));var u=r[0],o={};u.NumberFlag?b.set(o,"NumberValue",t):u.TextFlag?b.set(o,"TextValue",t):u.DateFlag?b.set(o,"DateValue",t):u.YesNoFlag?b.set(o,"YesNoValue",t):u.CalcRateFlag?b.set(o,"CalcRateValue",t):u.CommentFlag?b.set(o,"CommentValue",t):u.CurrencyFlag?b.set(o,"CurrencyValue",t):u.ListValuesFlag?b.set(o,"ListValue",t):u.Q1Q2Q3Flag?(b.set(o,"Q2Value",t[1]),b.set(o,"Q3Value",t[2])):u.ValueFlag&&b.set(o,"Value",t),n.updateDetail(e,o).then(function(e){i(e)}).catch(function(e){s(e)})}).catch(function(e){s(e)})})},t.getAllDataDetails=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDataGroup/GetItemsForXml",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.setCaseData=function(e,t){var n=this;return new Promise(function(i,s){var r=n,u=t;r.getAllDataDetails(e).then(function(e){var t=e;b.forEach(u,function(e){var n=e.code.split("."),u=e.value,o=0,a=new Promise(function(e,i){b.forEach(t,function(i,s){n.length>1&&i.GroupCode==n[0]&&i.DetailCode==n[1]||1==n.length&&i.DetailCode==n[0]?e(o=i.CaDataDetailId):s===t.length-1&&e(0)})});a.then(function(t){o>0?r.updateDetailItemValue(o,u).then(function(e){i(e)}).catch(function(e){s(e)}):s(new c(2,"The matching data detail item was not found for "+e.code))})})}).catch(function(e){s(e)})})},t.setCaseDataItem=function(e,t,n){var i=this;return new Promise(function(s,r){i.setCaseData(e,[{code:t,value:n}]).then(function(e){s(e)}).catch(function(e){r(e)})})},e}(),E=require("lodash"),F=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.addFee=function(e,t,n){var i=this;return new Promise(function(s,r){var u=E.merge({CaObjectId:e,FeeSetupId:t},n);i.cw.runRequest("Pll/CaseFees/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.addPayment=function(e,t){var n=this;return new Promise(function(i,s){var r=E.merge({CaObjectId:e},t);n.cw.runRequest("Pll/CasePayment/Add",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addRefund=function(e,t,n){var i=this;return new Promise(function(s,r){i.cw.runRequest("Pll/CasePaymentRefund/Add",{CaPaymentId:e,RefundAmount:t,Comments:n}).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.addDepositPayment=function(e,t){var n=this;return new Promise(function(i,s){var r=E.merge({CaDepositId:e},t);n.cw.runRequest("Pll/CasePayment/AddDeposit",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addDeposit=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o={CaObjectId:e,DepositId:t};void 0!==n&&E.set(o,"Amount",n),void 0!==i&&E.set(o,"CommentText",i),s.cw.runRequest("CaseDeposit/Add",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.addInstrument=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c=E.merge({CaObjectId:e,InstTypeId:t,Amount:n,DateExpire:i},s);r.cw.runRequest("Pll/CaseInstrument/Add",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.updateFee=function(e,t){var n=this;return new Promise(function(i,s){var r=E.merge({CaFeeId:e},t);n.cw.runRequest("Pll/CaseFees/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.voidRefund=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CasePaymentRefund/Update",{CaPaymentRefundId:e,Voided:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addDefaultFees=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CaseFees/AddDefault",{CaObjectId:e,BusCaseId:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addDefaultDeposits=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CaseDeposit/AddDefault",{CaObjectId:e,BusCaseId:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getFees=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseFees/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getDeposits=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDeposit/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getPayments=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CasePayment/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getInstruments=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseInstrument/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteFee=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseFees/Delete",{CaFeeId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteFeesByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseFees/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deletePayment=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CasePayment/Delete",{CaFeeId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteRefund=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CasePaymentRefund/Delete",{CaPaymentRefundId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deletePaymentsByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CasePayment/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteDeposit=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDeposit/Delete",{CaDepositId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteDepositsByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseDeposit/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteInstrument=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseInstrument/Delete",{CaInstrumentId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteInstrumentsByCaseId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseInstrument/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchFees=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["CaFeeId","CaObjectId","FeeCode","FeeDesc"]).length&&i(new c(4,"At least one of the attributes (CaFeeId, CaObjectId, FeeCode, FeeDesc) must be defined.")),t.cw.runRequest("Pll/CaseFees/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchPayments=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["CaPaymentId","CommentText","FeeAmount","FeeCode","FeeDesc","PaymentAccount","PaymentAmount","TenderType"]).length&&i(new c(5,"At least one of the attributes (CaPaymentId, CommentText, FeeAmount, FeeCode, FeeDesc, PaymentAccount, PaymentAmount, TenderType) must be defined.")),t.cw.runRequest("Pll/CasePayment/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchRefunds=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["CaPaymentId","CaPaymentRefundId","Comments","RefundAmount"]).length&&i(new c(6,"At least one of the attributes (CaPaymentId, CaPaymentRefundId, Comments, RefundAmount) must be defined.")),t.cw.runRequest("Pll/CasePayment/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchDeposits=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["CaDepositId","CaObjectId","DepositCode","DepositDesc"]).length&&i(new c(1,"At least one of the arguments (CaDepositId, CaObjectId, DepositCode, DepositDesc) must be defined.")),t.cw.runRequest("Pll/CaseDeposit/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getAllFeeTemplates=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/FeeSetup/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.searchFeeTemplates=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["FeeSetupId","FeeTypeId","FeeCode","FeeDesc","AccountCode"]).length&&i(new c(7,"At least one of the arguments (FeeSetupId, FeeTypeId, FeeCode, FeeDesc, AccountCode) must be defined.")),t.cw.runRequest("Pll/FeeSetup/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchCaseInstruments=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["AddressLine1","Amount","CaInstrumentId","CityName","CommentText","Company","ContactEmail","ContactName","ContactPhone","CountryCode","InstTypeId","SerialNumber","StateCode","ZipCode"]).length&&i(new c(9,"At least one of the arguments (AddressLine1, Amount, CaInstrumentId, CityName, CommentText, Company, ContactEmail, ContactName, ContactPhone, CountryCode, InstTypeId, SerialNumber, StateCode, ZipCode) must be defined.")),t.cw.runRequest("Pll/CaseInstrument/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getInstrumentList=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseInstrument/GetList",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.addCaseInstrumentRelease=function(e,t,n,i,s,r){var u=this;return new Promise(function(o,a){var d={CaInstrumentId:e,DateReleased:n,ReleasedBy:t};void 0===s&&null==s||void 0===i&&null==i?void 0!==s&&null!=s?E.set(d,"PercentReleased",s):void 0!==i&&null!=i&&E.set(d,"AmountReleased",i):a(new c(2,"Either amountReleased or percentReleased must be specified.")),void 0!==r&&E.set(d,"CommentText",r),u.cw.runRequest("Pll/CaseInstReleases/Add",d).then(function(e){o(e.Value)}).catch(function(e){a(e)})})},t.deleteCaseInstrumentRelease=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseInstReleases/Delete",{CaInstReleasesId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchCaseInstrumentReleases=function(e){var t=this;return new Promise(function(n,i){var s=e;0==E.intersectionBy(E.keysIn(e),["AmountReleased","CaInstReleasesId","CaInstrumentId","CommentText","PercentReleased","ReleasedBy"]).length&&i(new c(3,"At least one of the attributes (AmountReleased, CaInstReleasesId, CaInstrumentId, CommentText, PercentReleased, ReleasedBy) must be defined.")),t.cw.runRequest("Pll/CaseInstReleases/Search",s).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.fees=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/FeeSetup/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.searchAvailableFees=function(e){var t=this;return new Promise(function(n,i){0==E.intersectionBy(E.keysIn(e),["AccountCode","FeeCode","FeeDesc","FeeSetupId","FeeTypeId"]).length&&i(new c(8,"At least one of the attributes (AccountCode, FeeCode, FeeDesc, FeeSetupId, FeeTypeId) must be defined.")),t.cw.runRequest("Pll/FeeSetup/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTenderTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/TenderType/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addTenderType=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/TenderType/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateTenderType=function(e,t){var n=this;return new Promise(function(i,s){var r=E.merge({TenderTypeId:e},t);n.cw.runRequest("Pll/TenderType/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},e}(),W=require("lodash"),L=/*#__PURE__*/function(){function e(e,t){if(this.cw=void 0,this.activityTypes=void 0,this.currentActivityType=void 0,this.cw=e,this.activityTypes=new r.default,this.activityTypes.set("Unknown",0),this.activityTypes.set("Request",1),this.activityTypes.set("WorkOrder",2),this.activityTypes.set("CaTask",3),this.activityTypes.set("CaObject",4),this.activityTypes.set("CaCorrection",5),this.activityTypes.set("Project",6),this.activityTypes.set("Contract",7),!this.activityTypes.has(t))throw new c(1,"Comment activity type not found.",{provided:t,options:this.activityTypes});this.currentActivityType=t}var t=e.prototype;return t.add=function(e,t){var n=this;return new Promise(function(i,s){var r={ActivityType:n.activityTypes.get(n.currentActivityType),ActivitySid:e,Comments:t};n.cw.runRequest("Ams/Comment/Add",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.update=function(e,t){var n=this;return new Promise(function(i,s){var r={ActivityType:n.activityTypes.get(n.currentActivityType),CommentId:e,Comments:t};n.cw.runRequest("Ams/Comment/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.get=function(e){var t=this;return new Promise(function(n,i){if(void 0!==e&&null!=e){var s={ActivitySids:e,ActivityType:t.activityTypes.get(t.currentActivityType)};t.cw.runRequest("Ams/Comment/ByActivitySids",s).then(function(t){n(1==e.length?t.Value[e[0]]:t.Value)})}})},t.getPredefined=function(e,t){var n=this;return new Promise(function(i,s){var r={};"Request"==n.currentActivityType&&W.set(r,"ProblemSid",e),void 0===t||"Request"!=n.currentActivityType&&"WorkOrder"!=n.currentActivityType||W.set(r,"Category",t),W.set(r,"ActivityType",n.activityTypes.get(n.currentActivityType)),n.cw.runRequest("Ams/Comment/PredefinedComments",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},e}(),G=require("lodash"),B=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.task=void 0,this.cw=e,this.task={comment:new L(e,"CaTask")}}var t=e.prototype;return t.addTask=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c={CaObjectId:e,TaskId:t,StartPoint:n,EndPoint:i};void 0!==s&&(c=G.merge(c,s)),r.cw.runRequest("Pll/CaseTask/Add",c).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.addTaskResult=function(e,t,n,i,s,r){var u=this;return new Promise(function(o,c){var a={CaObjectId:e,CaTaskId:t,ResultCode:n,ResultID:i,ResultSetID:s};void 0!==r&&(a=G.merge(a,r)),u.cw.runRequest("Pll/CaseTaskResults/Add",a).then(function(e){o(e.Value)}).catch(function(e){c(e)})})},t.addTaskComment=function(e,t){var n=this;return new Promise(function(i,s){n.cw.runRequest("Pll/CaseTaskComments/Add",{CaTaskId:e,CommentText:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getTasksByCaseId=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Pll/CaseTask/ByCaObjectId",{CaObjectId:e,CheckRelatedItems:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getTasksById=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Pll/CaseTask/ByIds",{CaTaskIds:e,CheckRelatedItems:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getResultsByTaskId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTaskResults/ByCaTaskIds",{CaTaskIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getCommentsForTask=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTaskComments/ByCaTaskId",{caTaskId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getCommentsForTasks=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTaskComments/ByCaTaskIds",{caTaskIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateTask=function(e,t){var n=this;return new Promise(function(i,s){var r={CaTaskId:e};void 0!==t&&(r=G.merge(r,t)),n.cw.runRequest("Pll/CaseTask/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.updateTaskComment=function(e,t,n){var i=this;return new Promise(function(s,r){var u={CaTaskCommentId:e,CommentText:t};void 0!==n&&G.set(u,"CommentId",n),i.cw.runRequest("Pll/CaseTaskComments/Update",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.setTaskResult=function(e,t,n){var i=this;return new Promise(function(t,s){var r={CaTaskId:e};0==G.intersectionBy(G.keysIn(n),["TaskCompleteDate","TaskCompletedBy"]).length&&s(new c(2,"At least one of the attributes (TaskCompletedBy, TaskCompleteDate) must be defined.")),void 0!==n&&(r=G.merge(r,n)),i.cw.runRequest("Pll/CaseTask/SetResult",r).then(function(e){t(e.Value)}).catch(function(e){s(e)})})},t.deleteTask=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTask/Delete",{CaTaskId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteTasksOnCase=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTask/DeleteByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteTaskComments=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTaskComments/Delete",{CaTaskCommentIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForTasks=function(e){var t=this;return new Promise(function(n,i){0==G.intersectionBy(G.keysIn(e),["ResponsibleUserId","TaskAvailable","TaskComplete","TaskType"]).length&&i(new c(1,"At least one of the attributes (ResponsibleUserId, TaskAvailable, TaskComplete, TaskType) must be defined.")),t.cw.runRequest("Pll/CaseTask/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchForTaskResults=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseTaskResults/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.addTaskAttachment=function(e,t,n,i,s){var r=this;return new Promise(function(u,o){var c={CaObjectId:t,CaTaskId:e,DocName:n};void 0!==s&&G.set(c,"LocationType",s),r.cw.runRequest("Pll/CaseRelDocs/AddTaskRelDoc",c,i).then(function(e){u(e.Value)}).catch(function(e){o(e)})})},t.getTaskAttachments=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseRelDocs/ByCaTaskId",{CaTaskId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteTaskAttachment=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("PLL/CaseRelDocs/Delete",{CaRelDocId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),M=require("lodash"),N=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.addBusinessCaseTemplate=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/BusinessCase/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateBusinessCaseTemplate=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge({BusCaseId:e},t);n.cw.runRequest("Pll/BusinessCase/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getBusinessCaseTemplates=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/BusinessCase/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addCaseType=function(e,t,n){var i=this;return new Promise(function(s,r){var u=M.merge({CaseType:e,CaseTypeDesciption:t},n);i.cw.runRequest("Pll/CaseType/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.updateCaseType=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge({CaseTypeId:e},t);n.cw.runRequest("Pll/CaseType/GetList",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getCaseTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/CaseType/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.searchCaseTypeIDs=function(e){var t=this;return new Promise(function(n,i){0==M.intersectionBy(M.keysIn(e),["CaseType","CaseTypeDesc","CaseTypeId"]).length&&i(new c(2,"At least one of the attributes (CaFeeId, CaObjectId, FeeCode, FeeDesc) must be defined.")),t.cw.runRequest("Pll/CaseType/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.searchCaseTypeObjects=function(e){var t=this;return new Promise(function(n,i){0==M.intersectionBy(M.keysIn(e),["CaseType","CaseTypeDesc","CaseTypeId"]).length&&i(new c(3,"At least one of the attributes (CaseType, CaseTypeDesc, CaseTypeId) must be defined.")),t.cw.runRequest("Pll/CaseType/SearchObject",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.addSubtype=function(e,t,n){var i=this;return new Promise(function(s,r){var u=M.merge({SubType:e,SubTypeDesc:t},n);i.cw.runRequest("Pll/SubType/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.updateSubtype=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge({SubTypeId:e},t);n.cw.runRequest("Pll/SubType/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getSubtypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/SubType/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getFees=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/FeeSetup/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.searchFees=function(e){var t=this;return new Promise(function(n,i){0==M.intersectionBy(M.keysIn(e),["AccountCode","FeeCode","FeeDesc","FeeSetupId","FeeTypeId"]).length&&i(new c(4,"At least one of the attributes (AccountCode, FeeCode, FeeDesc, FeeSetupId, FeeTypeId) must be defined.")),t.cw.runRequest("Pll/FeeSetup/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getExpirations=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/ExpirationType/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addExpiration=function(e){var t=this;return new Promise(function(n,i){M.has(e,"OrgId")&&M.has(e,"ExpirationTypeDesc")||i(new c(5,"OrgId and ExpirationTypeDesc must both be defined.")),t.cw.runRequest("Pll/ExpirationType/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getDeposits=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/Deposit/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.searchDeposits=function(e){var t=this;return new Promise(function(n,i){0==M.intersectionBy(M.keysIn(e),["AccountCode","DepositCode","DepositDesc","DepositId","DepositTypeId"]).length&&i(new c(4,"At least one of the attributes (AccountCode, DepositCode, DepositDesc, DepositId, DepositTypeId) must be defined.")),t.cw.runRequest("Pll/Deposit/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getDisciplines=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/Discipline/All",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addDepartment=function(e,t,n){var i=this;return new Promise(function(s,r){var u=M.merge({DepartmentCode:e,DepartmentName:t},n);i.cw.runRequest("Pll/Department/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getDepartments=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/Department/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addDivision=function(e,t,n){var i=this;return new Promise(function(s,r){var u=M.merge({DepartmentId:e,DivisionName:t},n);i.cw.runRequest("Pll/Division/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getDivisions=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/Division/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addInspectionTimeBlock=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o={LabelText:e,StartTime:t,EndTime:n};void 0!==i&&M.set(o,"InspTimeBlocksDetails",i),s.cw.runRequest("Pll/InspectionTimeBlock/Add",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.getInspectionTimeBlocks=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/InspectionTimeBlock/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getNotificationCases=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/NotificationCase/GetNotificationCaseList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getNotificationTypes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/NotificationType/GetNotificationTypeList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addNumberingGroup=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/NumberingGroup/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateNumberingGroup=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge({NumberingGroupId:e},t);n.cw.runRequest("Pll/NumberingGroup/Update",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getNumberingGroups=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/NumberingGroup/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addPerson=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge(t,{Name:e});n.cw.runRequest("Pll/People/Add",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getPeople=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/People/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addPeopleRole=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge(t,{RoleCode:e});n.cw.runRequest("Pll/People/Add",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getPeopleRoles=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/PeopleRole/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addTaskResultDetail=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/TaskResultDetail/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateTaskResultDetail=function(e,t){var n=this;return new Promise(function(i,s){var r=M.merge(t,{ResultDetailId:e});n.cw.runRequest("Pll/TaskResultDetail/Add",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getTaskResultDetails=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/TaskResultDetail/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addTaskResultFeeInsert=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/TaskResultFeeInsert/Add",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteTaskResultFeeInsert=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/TaskResultFeeInsert/Delete",{TaskResultFeeInsertId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteTaskResultFeeInsertByTaskId=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/TaskResultFeeInsert/DeleteByTaskId",{TaskId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.updateTaskResultFeeInsert=function(e,t,n,i){var s=this;return new Promise(function(r,u){var o={TaskResultFeeInsertId:e,TaskId:t,TaskResultId:n};void 0!==i&&M.set(o,"FeeSetupId",i),s.cw.runRequest("Pll/TaskResultFeeInsert/Update",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.getTaskResultFeeInsert=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Pll/TaskResultFeeInsert/GetList",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},e}(),j=require("lodash"),x=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.attach=function(e,t,n){var i=this;return void 0===t&&(t=!0),new Promise(function(s,r){var u={CaObjectId:e,UpdateXY:t};void 0!==n&&(u=j.merge(u,n)),i.cw.runRequest("Pll/CaseAddress/Add",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.detach=function(e,t){var n=this;return void 0===t&&(t=!0),new Promise(function(i,s){n.cw.runRequest("Pll/CaseAddress/Delete",{CaAddressId:e,UpdateXY:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.detachAll=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Pll/CaseAddress/DeleteByCaObjectId",{CaObjectId:e,UpdateXY:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getForCase=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Pll/CaseAddress/ByCaObjectId",{CaObjectId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.search=function(e){var t=this;return new Promise(function(n,i){0==j.intersectionBy(j.keysIn(e),["AssetType","CaAddressId","CaObjectId","CityName","ExpiredFlag","StateCode","StateName","StreetName","StreetNumber","Suite","ZipCode"]).length&&i(new c(3,"At least one of the attributes (AssetType, CaAddressId, CaObjectId, CityName, ExpiredFlag, StateCode, StateName, StreetName, StreetNumber, Suite, ZipCode) must be defined.")),t.cw.runRequest("Pll/CaseAddress/Search",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}();require("lodash");var U=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}var t=e.prototype;return t.getEntityGroups=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/Entity/Groups",{}).then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.getEntityTypes=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplates",{EntityGroups:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplates=function(e,t,n){var i=this;return void 0===t&&(t=!0),void 0===n&&(n=!0),new Promise(function(s,r){i.cw.runRequest("Ams/Designer/WOTemplates",{EntityType:e,IncludeComments:t,IncludeInstructions:n}).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.updateTemplate=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplates",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateGroupRights=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplates",{WOTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateActivity=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateActivityService",{WOTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getUpdateFields=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateUpdateFields",{WOTemplateIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateEquipment=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateEquipment",{WOTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateLabor=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateLabor",{WOTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateMaterial=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateMaterial",{WOTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateMapLayerFields=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WorkOrderTemplateMapLayerFields",{WorkOrderTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getTemplateTasks=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Tasks/ByWorkOrderTemplate",{WOTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getRelatedInspectionTemplates=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/Designer/WOTemplateInspections",{WOTemplateId:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),_=require("lodash"),Q=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}return e.prototype.getTemplates=function(e,t,n){var i=this;return new Promise(function(s,r){var u={};void 0!==e&&(u.EntityTypes=e),u.CanCreate=void 0===t||t,"object"==typeof n&&_.forIn(n,function(e,t){u[t]=e}),i.cw.runRequest("Ams/InspectionTemplate/Templates",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},e}();require("lodash");var H=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.cw=e}return e.prototype.getTemplates=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/ServiceRequestTemplate/Templates",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),K=require("lodash"),Y=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.currentActivityType=void 0,this.cw=e,this.currentActivityType="WorkOrder"}var t=e.prototype;return t.getCodes=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/CostCodes",{EmployeeSids:e,CommonCodesOnly:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getJobCodes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/LaborCost/JobCodes").then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addLabor=function(e,t,n){var i=this;return new Promise(function(s,r){var u={WorkOrderSid:e,Hours:t};void 0!==n&&(u=K.merge(u,n)),i.cw.runRequest("Ams/LaborCost/AddWorkOrderCosts",u).then(function(e){s(e.Value)}).catch(function(e){r(e)})})},t.getLabor=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/WorkOrderCostsByWorkOrder",{Estimated:t,WorkOrderSids:e}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteLabor=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/DeleteWorkOrderCosts",{LaborCostIds:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addEquipment=function(e,t){var n=this;return new Promise(function(i,s){var r={WorkOrderSid:e};void 0!==t&&(r=K.merge(r,t)),n.cw.runRequest("Ams/EquipmentCost/AddWorkOrderCosts",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getEquipment=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/EquipmentCost/WorkOrderCostsByWorkOrder",{WorkOrderSid:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteEquipment=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/EquipmentCost/DeleteWorkOrderCosts",{EquipmentCostIds:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addMaterial=function(e,t,n,i){var s=this;return void 0===i&&(i=!0),new Promise(function(r,u){var o={Units:t,WorkOrderSid:e,CombineIssuesByMaterialSid:i};void 0!==n&&(o=K.merge(o,n)),s.cw.runRequest("Ams/MaterialCost/AddWorkOrderCosts",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.getMaterial=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/MaterialCost/AddWorkOrderCosts",{WorkOrderSid:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteMaterial=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/MaterialCost/DeleteWorkOrderCosts",{MaterialCostIds:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},e}(),J=require("lodash"),X=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.currentActivityType=void 0,this.cw=e,this.currentActivityType="Inspection"}var t=e.prototype;return t.getCodes=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/CostCodes",{EmployeeSids:e,CommonCodesOnly:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getJobCodes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/LaborCost/JobCodes").then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addLabor=function(e,t,n,i){var s=this;return void 0===i&&(i=!1),new Promise(function(r,u){var o={Estimated:i,InspectionIds:e,Hours:t};void 0!==n&&(o=J.merge(o,n)),s.cw.runRequest("Ams/LaborCost/AddInspectionCosts",o).then(function(e){r(e.Value)}).catch(function(e){u(e)})})},t.getLabor=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/InspectionCostsByInspection",{Estimated:t,InspectionIds:e}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteLabor=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/DeleteInspectionCosts",{Estimated:t,reqLaborCostIds:e}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.addEquipment=function(e,t){var n=this;return new Promise(function(i,s){var r={InspectionId:e};void 0!==t&&(r=J.merge(r,t)),n.cw.runRequest("Ams/EquipmentCost/AddInspectionCosts",r).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getEquipment=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/EquipmentCost/InspectionCostsByInspection",{InspectionIds:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.deleteEquipment=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/EquipmentCost/DeleteInspectionCosts",{EquipmentCostIds:e,Estimated:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},e}();require("lodash");var z=/*#__PURE__*/function(){function e(e){this.cw=void 0,this.currentActivityType=void 0,this.cw=e,this.currentActivityType="Request"}var t=e.prototype;return t.getCodes=function(e,t){var n=this;return void 0===t&&(t=!1),new Promise(function(i,s){n.cw.runRequest("Ams/LaborCost/CostCodes",{EmployeeSids:e,CommonCodesOnly:t}).then(function(e){i(e.Value)}).catch(function(e){s(e)})})},t.getJobCodes=function(){var e=this;return new Promise(function(t,n){e.cw.runRequest("Ams/LaborCost/JobCodes").then(function(e){t(e.Value)}).catch(function(e){n(e)})})},t.addLabor=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/LaborCost/AddRequestCosts",e).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.getLabor=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/LaborCost/RequestCostsByRequest",{RequestIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},t.deleteLabor=function(e){var t=this;return new Promise(function(n,i){t.cw.runRequest("Ams/LaborCost/DeleteRequestCosts",{LaborCostIds:e}).then(function(e){n(e.Value)}).catch(function(e){i(e)})})},e}(),Z=require("https"),$=require("querystring"),ee=require("lodash");require("form-data");var te=require("fs");require("path");var ne=require("axios"),ie=new(/*#__PURE__*/function(){function e(e,t,n){this.base_url=void 0,this.Token=void 0,this.login=void 0,this.password=void 0,this.gisToken=void 0,this.gisTokenUrl=void 0,this.settings=void 0,this.error=void 0,this.extensions=void 0,this.features=void 0,this.potential_loads=void 0,this.base_url="cityworksonline",this.extensions={UnknownExtension:0,CwAnalytics:1,WebHooks:2,PLLPublicApp:3,ActivityUpdate:4,SingleSignOn:5},this.features={UnknownFeature:0,ViewInspections:1,EditInspections:2,ViewServiceRequest:3,EditServiceRequest:4,ViewWorkOrder:5,EditWorkOrder:6,EquipmentCheckOut:7,OfficeField:8,Respond:9,Eurl:10,PaverInterface:11,Contracts:12,Storeroom:13,PLL:14,Cw4XL:15,TableEditor:16,CCTVInterface:17,MobileAndroid:18,MobileiOS:19,PerformanceBudgeting:20,Insights:21,RespondCase:22,RespondInspection:23,RespondServiceRequest:24,RespondTaskManager:25,RespondWorkOrder:26,Workload:27,OpX:28,TrimbleUnityMobile:29,TrimbleVegetationManager:30},this.settings={path:"cityworks",secure:!0,expires:null,default_domain:null,version:23},this.potential_loads=["general","activity_link","message_queue","gis","search","request","case","case_financial"],void 0!==e&&this.configure(e,t,n)}var t=e.prototype;return t.configure=function(e,t,n){var i=this;this.base_url=void 0!==e?e:"cityworksonline",this.settings={path:"cityworks",secure:!0,expires:null,default_domain:null,version:23},void 0!==t&&ee.forEach(t,function(e,t){void 0!==i.settings[t]&&(i.settings[t]=e)})},t.runRequest=function(e,t,n){var i=this;return new Promise(function(s,r){var u={};void 0!==t&&(u.data=JSON.stringify(t)),i.settings.version<23&&void 0!==i.Token&&""!=i.Token&&"General/Authentication/CityworksOnlineAuthenticate"!=e&&"General/Authentication/Authenticate"!=e&&(u.token=i.Token);var o={hostname:i.base_url,port:443,path:"/"+i.settings.path+"/services/"+e,method:"POST",headers:{},timeout:1e7};if(0==i.settings.secure&&(o.port=80),i.settings.version>=23&&void 0!==i.Token&&""!=i.Token&&"General/Authentication/CityworksOnlineAuthenticate"!=e&&"General/Authentication/Authenticate"!=e&&ee.set(o,"headers.Authorization","cityworks "+i.Token),void 0!==n){var a="https://";80==o.port&&(a="http://"),a+=o.hostname+o.path,i.settings.version<23&&void 0!==i.Token&&""!=i.Token&&"General/Authentication/CityworksOnlineAuthenticate"!=e&&"General/Authentication/Authenticate"!=e&&(a+="?token="+i.Token),ne.postForm(a,{data:JSON.stringify(t),file:te.createReadStream(n)},{headers:o.headers}).then(function(e){s(e.data)})}else{ee.set(o,"headers.Content-Type","application/x-www-form-urlencoded"),ee.set(o,"headers.Content-Length",Buffer.byteLength($.stringify(u)));var d=Z.request(o,function(e){var t="";e.on("error",function(e){r(new c(13,"Unknown error.",e))}),e.on("data",function(e){t+=e}),e.on("end",function(){try{if(null==(JSON.stringify(t)+"[test string]").match(/\<h2\>Object\ moved\ to/)){var e=JSON.parse(t);if(void 0===e)r(new c(10,"No response received from Cityworks API."));else if(void 0!==e)switch(e.Status){case 1:r(new c(1,"Error",e));break;case 2:r(new c(2,"Unauthorized",e));break;case 3:r(new c(3,"InvalidCredentials",e));break;default:s(void 0!==e&&void 0===e.Value&&0==e.Status||e)}else r(new c(4,"Unknown error.",{options:o,postedData:u,api_returned_string:e}))}else r(new c(5,"Error parsing JSON. Cityworks returned HTML.",{response:t}))}catch(e){e instanceof SyntaxError?(console.log("try/catch error on JSON"),r(new c(6,"Error parsing JSON.",e))):(console.log("try/catch error on JSON - but not an instance of SyntaxError"),r(new c(7,"Error parsing JSON.",e)))}})});d.write($.stringify(u)),d.end()}})},t.authenticate=function(e,t){var n=this;return new Promise(function(i,s){var r="General/Authentication/Authenticate";"cityworksonline"==n.base_url&&(r="General/Authentication/CityworksOnlineAuthenticate"),n.runRequest(r,{LoginName:e,Password:t}).then(function(r){r.Status>0?s(new c(100,r.Message)):void 0!==r.Value&&void 0!==r.Value.Token?(n.login=e,n.password=t,n.Token=r.Value.Token,i(!0)):s(new c(11,"Unknown Error"))}).catch(function(e){s(e)})})},t.authenticateWithGISToken=function(e,t,n,i){var s=this;return this.login=e,this.gisToken=t,this.gisTokenUrl=n,void 0!==i&&(i=12096e5),new Promise(function(e,t){s.runRequest("General/Authentication/AuthenticateGisToken",{LoginName:s.login,GisToken:s.gisToken,GisTokenUrl:s.gisTokenUrl,Expires:i}).then(function(t){void 0!==t.Status&&t.Status>0||(void 0!==t.Value&&void 0!==t.Value.Token?(s.Token=t.Value.Token,e(!0)):e(!1))}).catch(function(e){throw e})})},t.validateToken=function(e,t){var n=this;return new Promise(function(i,s){n.runRequest("General/Authentication/Validate",{Token:e}).then(function(s){s.Status>0?i(!1):(t&&(n.Token=e),i(s.Value))}).catch(function(e){throw e})})},t.setToken=function(e){return""!=e&&null!=e&&(this.Token=e,!0)},t.getToken=function(){return""!=this.Token&&null!=this.Token&&this.Token},t.revokeToken=function(e){var t=this;return new Promise(function(n,i){t.runRequest("General/Token/RevokeUser",{RevokeDate:e}).then(function(e){n(!(void 0!==e.Status&&e.Status>0))}).catch(function(e){throw e})})},t.getLocalizationSettings=function(){var e=this;return new Promise(function(t,n){e.runRequest("General/Localization/LocalizationSettings",{}).then(function(e){t(e.Value)})})},t.getTimezoneOptions=function(){var e=this;return new Promise(function(t,n){e.runRequest("General/Localization/TimeZones",{}).then(function(e){t(e.Value)})})},t.getCurrentLocation=function(){var e=this;return new Promise(function(t,n){e.runRequest("General/AppData/CurrentLocation",{}).then(function(e){t(e.Value)})})},t.licensedApiCheck=function(e,t){var n=this;return new Promise(function(i,s){n.runRequest("General/AppData/SelectedEntities",{Area:e,Service:t}).then(function(e){i(e.Value)})})},t.licensedExtensionCheck=function(e){var t=this;return new Promise(function(n,i){void 0===t.extensions[e]&&i(new c(4,"Extension provided does not exist or is mispelled.",{provided:e,available:t.extensions})),t.runRequest("General/Authorization/LicensedExtensionCheck",{Extension:t.extensions[e]}).then(function(e){n(e.Value)})})},t.licensedExtensionsCheck=function(e){var t=this;return new Promise(function(n,i){var s={Extensions:[]};ee.forEach(e,function(e){void 0===t.extensions[e]?i(new c(5,"Extension provided does not exist or is mispelled.",{provided:e,available:t.extensions})):s.Extensions.push(t.extensions[e])}),t.runRequest("General/Authorization/LicensedExtensionsCheck",s).then(function(e){var s={},r=ee.invert(t.extensions);ee.forEach(e,function(e,n){void 0===r[e]?i(new c(6,"Extension index provided does not exist or isn't configured properly.",{provided_num_returned:e,available:t.extensions})):s[r[e]]=n}),n(s)})})},t.licensedFeatureCheck=function(e){var t=this;return new Promise(function(n,i){void 0===t.features[e]&&i(new c(7,"Feature provided does not exist or is mispelled.",{provided:e,available:t.features})),t.runRequest("General/Authorization/LicensedFeatureCheck",{Feature:t.features[e]}).then(function(e){n(e.Value)})})},t.licensedFeaturesCheck=function(e){var t=this;return new Promise(function(n,i){var s={Features:[]};ee.forEach(e,function(e){void 0===t.features[e]?i(new c(8,"Feature provided does not exist or is mispelled.",{provided:e,available:t.features})):s.Features.push(t.features[e])}),t.runRequest("General/Authorization/LicensedFeaturesCheck",s).then(function(e){var s={},r=ee.invert(t.features);ee.forEach(e.Value,function(e,t){void 0===r[e]?i(new c(9,"Feature index provided does not exist or isn't configured properly.",{provided:e,available:r})):s[r[e]]=t}),n(s)})})},t.licensedServicesCheck=function(e){var t=this;return new Promise(function(n,i){t.runRequest("General/Authorization/LicensedServicesCheck",{Services:e}).then(function(e){n(e.Value)})})},t.cityworksOnlineSites=function(e,t){var n=this;return new Promise(function(i,s){n.runRequest("General/Authentication/CityworksOnlineSites",{LoginName:void 0!==e?e:n.login,Password:void 0!==t?t:n.password}).then(function(e){i(e.Value)})})},t.domains=function(){var e=this;return new Promise(function(t,n){e.runRequest("General/Authentication/Domains",{}).then(function(e){t(e.Value)})})},t.user=function(e){var t=this;return new Promise(function(n,i){t.runRequest("General/Authentication/User",{LoginName:void 0!==e?e:t.login}).then(function(e){n(e.Value)})})},t.version=function(){var e=this;return new Promise(function(t,n){e.runRequest("General/Authentication/Version",{}).then(function(e){t(e.Value)})})},e}()),se=new d(ie),re=new m(ie),ue=new w(ie),oe=new I(ie),ce=new P(ie),ae=new v(ie),de=new T(ie),fe=new A(ie),le=new k(ie),he=new D(ie);he.data=new O(ie),he.financial=new F(ie),he.workflow=new B(ie),he.admin=new N(ie),he.comment=new L(ie,"CaObject"),he.asset=new x(ie),he.attachments=new l(ie,"Case"),le.admin=new U(ie),le.costs=new Y(ie),le.comment=new L(ie,"WorkOrder"),le.attachments=new l(ie,"WorkOrder"),fe.admin=new Q(ie),fe.costs=new X(ie),fe.attachments=new l(ie,"Inspection"),de.admin=new H(ie),de.costs=new z(ie),de.comment=new L(ie,"Request"),de.attachments=new l(ie,"Request"),e.Cityworks=ie,e.activity_link=re,e.briefcase=he,e.general=se,e.gis=ae,e.inspection=fe,e.message_queue=ue,e.query=ce,e.request=de,e.search=oe,e.workorder=le});
//# sourceMappingURL=index.umd.js.map
